---
layout: post
title: "Security vulnerability found in Cyberoam DPI devices (CVE-2012-3372)"
permalink: security-vulnerability-found-cyberoam-dpi-devices-cve-2012-3372
date: 2012-07-03
author: Runa
category: blog
tags: ["ca certificates", "dpi", "tor", "vulnerability"]
---

Last week, a user in Jordan reported seeing a fake certificate for [torproject.org](https://torproject.org/). The user did not report any errors when browsing to sites such as [Gmail](https://gmail.com), [Facebook](https://facebook.com), and [Twitter](https://twitter.com/), which suggests that this was a targeted attack. The certificate was issued by a company called [Cyberoam](http://www.cyberoam.com/). We first believed that this incident was similar to that of [Comodo](https://blog.torproject.org/blog/detecting-certificate-authority-compromises-and-web-browser-collusion) and [DigiNotar](https://blog.torproject.org/blog/diginotar-debacle-and-what-you-should-do-about-it), and that Cyberoam had been tricked to issue a fake certificate for our website.

<center>
<br>
<img src="https://media.torproject.org/image/blog-images/2012-07-03-screenshot-cyberoam-cropped.png"><br>
</center>

After a bit of research, we learned that Cyberoam [make a range of devices](http://www.cyberoamworks.com/) used for Deep Packet Inspection (DPI). The user was not just seeing a fake certificate for torproject.org, his connection was actually being intercepted by one of their devices. While investigating this further, Ben Laurie and I found a security vulnerability affecting all Cyberoam DPI devices.

Examination of a certificate chain generated by a Cyberoam DPI device shows that all such devices share the same CA certificate and hence the same private key. It is therefore possible to intercept traffic from any victim of a Cyberoam device with any other Cyberoam device - or to extract the key from the device and import it into other DPI devices, and use those for interception.

Ben and I wrote a [security advisory](https://media.torproject.org/misc/2012-07-03-cyberoam-CVE-2012-3372.txt) and notified Cyberoam of this vulnerability at 17:00 UTC on Saturday, June 30. We made it clear that we intended to publish this blog post and the security advisory on Tuesday, July 3, and encouraged them to respond promptly if they had any comments. At the same time, we notified browser vendors and asked that they blacklist the Cyberoam CA certificate in their browsers.

Cyberoam have not yet commented on this issue, apart from acknowledging our first email and saying that they are looking into it. The Cyberoam CA certificate is not trusted, and so browsers will show users a warning (unless someone has already installed the certificate). Users with the Tor Browser Bundle are not affected.

To check if this CA is installed in your browser, see the following instructions for [Internet Explorer, Firefox, Chrome](http://blog.devantis.com/?p=79), and [Safari](http://fairerplatform.com/2011/09/how-to-disable-diginotar-ssl-certificate/). The instructions mention DigiNotar, but they are still valid. If you have more information about this issue, please email [help@rt.torproject.org](mailto:help@rt.torproject.org).

