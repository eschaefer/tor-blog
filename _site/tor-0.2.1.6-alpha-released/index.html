<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Tor 0.2.1.6-alpha Released</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Tor 0.2.1.6-alpha Released</h2>
<p class="meta">15 Oct 2008</p>

<div class="post">
<p>Tor 0.2.1.6-alpha further improves performance and robustness of hidden<br>
services, starts work on supporting per-country relay selection, and<br>
fixes a variety of smaller issues.</p>

<p>The original announcement can be found at<br>
 <a href="http://archives.seul.org/or/talk/Oct-2008/msg00093.html" title="http://archives.seul.org/or/talk/Oct-2008/msg00093.html">http://archives.seul.org/or/talk/Oct-2008/msg00093.html</a></p>

<p>Changes in version 0.2.1.6-alpha - 2008-09-30</p>

<ul>
<li><p>Major features:</p>

<ul>
<li>Implement proposal 121: make it possible to build hidden services<br>
that only certain clients are allowed to connect to. This is<br>
enforced at several points, so that unauthorized clients are unable<br>
to send INTRODUCE cells to the service, or even (depending on the<br>
type of authentication) to learn introduction points. This feature<br>
raises the bar for certain kinds of active attacks against hidden<br>
services. Code by Karsten Loesing.</li>
<li>Relays now store and serve v2 hidden service descriptors by default,<br>
i.e., the new default value for HidServDirectoryV2 is 1. This is<br>
the last step in proposal 114, which aims to make hidden service<br>
lookups more reliable.</li>
<li>Start work to allow node restrictions to include country codes. The<br>
syntax to exclude nodes in a country with country code XX is<br>
&quot;ExcludeNodes {XX}&quot;. Patch from Robert Hogan. It still needs some<br>
refinement to decide what config options should take priority if<br>
you ask to both use a particular node and exclude it.</li>
<li>Allow ExitNodes list to include IP ranges and country codes, just<br>
like the Exclude*Nodes lists. Patch from Robert Hogan.</li>
</ul></li>
<li><p>Major bugfixes:</p>

<ul>
<li>Fix a bug when parsing ports in tor_addr_port_parse() that caused<br>
Tor to fail to start if you had it configured to use a bridge<br>
relay. Fixes bug 809. Bugfix on 0.2.1.5-alpha.</li>
<li>When extending a circuit to a hidden service directory to upload a<br>
rendezvous descriptor using a BEGIN_DIR cell, almost 1/6 of all<br>
requests failed, because the router descriptor had not been<br>
downloaded yet. In these cases, we now wait until the router<br>
descriptor is downloaded, and then retry. Likewise, clients<br>
now skip over a hidden service directory if they don&#39;t yet have<br>
its router descriptor, rather than futilely requesting it and<br>
putting mysterious complaints in the logs. Fixes bug 767. Bugfix<br>
on 0.2.0.10-alpha.</li>
<li>When fetching v0 and v2 rendezvous service descriptors in parallel,<br>
we were failing the whole hidden service request when the v0<br>
descriptor fetch fails, even if the v2 fetch is still pending and<br>
might succeed. Similarly, if the last v2 fetch fails, we were<br>
failing the whole hidden service request even if a v0 fetch is<br>
still pending. Fixes bug 814. Bugfix on 0.2.0.10-alpha.</li>
<li>DNS replies need to have names matching their requests, but<br>
these names should be in the questions section, not necessarily<br>
in the answers section. Fixes bug 823. Bugfix on 0.2.1.5-alpha.</li>
</ul></li>
<li><p>Minor features:</p>

<ul>
<li>Update to the &quot;September 1 2008&quot; ip-to-country file.<br></li>
<li>Allow ports 465 and 587 in the default exit policy again. We had<br>
rejected them in 0.1.0.15, because back in 2005 they were commonly<br>
misconfigured and ended up as spam targets. We hear they are better<br>
locked down these days.</li>
<li>Use a lockfile to make sure that two Tor processes are not<br>
simultaneously running with the same datadir.</li>
<li>Serve the latest v3 networkstatus consensus via the control<br>
port. Use &quot;getinfo dir/status-vote/current/consensus&quot; to fetch it.</li>
<li>Better logging about stability/reliability calculations on directory<br>
servers.</li>
<li>Drop the requirement to have an open dir port for storing and<br>
serving v2 hidden service descriptors.</li>
<li>Directory authorities now serve a /tor/dbg-stability.txt URL to<br>
help debug WFU and MTBF calculations.</li>
<li>Implement most of Proposal 152: allow specialized servers to permit<br>
single-hop circuits, and clients to use those servers to build<br>
single-hop circuits when using a specialized controller. Patch<br>
from Josh Albrecht. Resolves feature request 768.</li>
<li>Add a -p option to tor-resolve for specifying the SOCKS port: some<br>
people find host:port too confusing.</li>
<li>Make TrackHostExit mappings expire a while after their last use, not<br>
after their creation. Patch from Robert Hogan.</li>
<li>Provide circuit purposes along with circuit events to the controller.</li>
</ul></li>
<li><p>Minor bugfixes:</p>

<ul>
<li>Fix compile on OpenBSD 4.4-current. Bugfix on 0.2.1.5-alpha.<br>
Reported by Tas.</li>
<li>Fixed some memory leaks -- some quite frequent, some almost<br>
impossible to trigger -- based on results from Coverity.</li>
<li>When testing for libevent functions, set the LDFLAGS variable<br>
correctly. Found by Riastradh.</li>
<li>Fix an assertion bug in parsing policy-related options; possible fix<br>
for bug 811.</li>
<li>Catch and report a few more bootstrapping failure cases when Tor<br>
fails to establish a TCP connection. Cleanup on 0.2.1.x.</li>
<li>Avoid a bug where the FastFirstHopPK 0 option would keep Tor from<br>
bootstrapping with tunneled directory connections. Bugfix on<br>
0.1.2.5-alpha. Fixes bug 797. Found by Erwin Lam.</li>
<li>When asked to connect to A.B.exit:80, if we don&#39;t know the IP for A<br>
and we know that server B rejects most-but-not all connections to<br>
port 80, we would previously reject the connection. Now, we assume<br>
the user knows what they were asking for. Fixes bug 752. Bugfix<br>
on 0.0.9rc5. Diagnosed by BarkerJr.</li>
<li>If we are not using BEGIN_DIR cells, don&#39;t attempt to contact hidden<br>
service directories if they have no advertised dir port. Bugfix<br>
on 0.2.0.10-alpha.</li>
<li>If we overrun our per-second write limits a little, count this as<br>
having used up our write allocation for the second, and choke<br>
outgoing directory writes. Previously, we had only counted this when<br>
we had met our limits precisely. Fixes bug 824. Patch from by rovv.<br>
Bugfix on 0.2.0.x (??).</li>
<li>Avoid a &quot;0 divided by 0&quot; calculation when calculating router uptime<br>
at directory authorities. Bugfix on 0.2.0.8-alpha.</li>
<li>Make DNS resolved controller events into &quot;CLOSED&quot;, not<br>
&quot;FAILED&quot;. Bugfix on 0.1.2.5-alpha. Fix by Robert Hogan. Resolves<br>
bug 807.</li>
<li>Fix a bug where an unreachable relay would establish enough<br>
reachability testing circuits to do a bandwidth test -- if<br>
we already have a connection to the middle hop of the testing<br>
circuit, then it could establish the last hop by using the existing<br>
connection. Bugfix on 0.1.2.2-alpha, exposed when we made testing<br>
circuits no longer use entry guards in 0.2.1.3-alpha.</li>
<li>If we have correct permissions on $datadir, we complain to stdout<br>
and fail to start. But dangerous permissions on<br>
$datadir/cached-status/ would cause us to open a log and complain<br>
there. Now complain to stdout and fail to start in both cases. Fixes<br>
bug 820, reported by seeess.</li>
<li>Remove the old v2 directory authority &#39;lefkada&#39; from the default<br>
list. It has been gone for many months.</li>
</ul></li>
<li><p>Code simplifications and refactoring:</p>

<ul>
<li>Revise the connection_new functions so that a more typesafe variant<br>
exists. This will work better with Coverity, and let us find any<br>
actual mistakes we&#39;re making here.</li>
<li>Refactor unit testing logic so that dmalloc can be used sensibly<br>
with unit tests to check for memory leaks.</li>
<li>Move all hidden-service related fields from connection and circuit<br>
structure to substructures: this way they won&#39;t eat so much memory.</li>
</ul></li>
</ul>

</div>
<p>- phobos</p>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
