<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>The Debian OpenSSL flaw: what does it mean for Tor clients?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A layout example that shows off a blog page with a list of posts.">
    <meta name="robots" content="noindex" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/styles.css">

    <!--[if lte IE 8]>
      <link rel="stylesheet" href="css/blog-old-ie.css">
    <![endif]-->
    <!--[if lt IE 9]>
      <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.js"></script>
    <![endif]-->
</head>
<body>

<body>
<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
        <div class="header">
            <img class="tor-logo" src="/assets/images/tor_logo.png" />
            <h1 class="brand-title">The Tor Project Blog</h1>
            <h2 class="brand-tagline">News and events from Tor</h2>

            <nav class="nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a class="pure-button" href="/events/">Events</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/overview">About Tor</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/donate/donate">Donate</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            <!-- A wrapper for all the blog posts -->
            <div class="posts">
                <h1 class="content-subhead">Recent Posts</h1>


               <h2>The Debian OpenSSL flaw: what does it mean for Tor clients?</h2>
<p class="meta">14 May 2008</p>

<div class="event">
<p>There have been a lot of questions today about just what <a href="http://lists.debian.org/debian-security-announce/2008/msg00152.html">the<br>
recent Debian OpenSSL</a> flaw means for Tor clients. Here&#39;s an attempt to<br>
explain it in a bit more detail. (Go read <a href="http://archives.seul.org/or/announce/May-2008/msg00000.html">the Tor security advisory</a> before<br>
reading this post.)</p>

<p>First, let&#39;s look at the security/anonymity implications for users who<br>
aren&#39;t running on Debian, Ubuntu, or similar. These implications all<br>
stem from the fact that some of the Tor relays and v3 directory authorities<br>
have weak keys, so the Tor network isn&#39;t able to provide as much anonymity<br>
as we would like.</p>

<p>The biggest issue is that perhaps 300 Tor relays were running with<br>
weak keys and weak crypto, out of the roughly 1500-2000 total running<br>
relays. What can an attacker do from this? If you happen to pick three<br>
weak relays in a row for your circuit, then somebody watching your local<br>
network connection (or watching the first relay you pick) could break all<br>
the layers of Tor encryption and read the traffic as if they were watching<br>
it at the exit relay. (I don&#39;t want to say they could read the plaintext,<br>
because if you used end-to-end encryption like SSL they wouldn&#39;t be able<br>
to see inside of that -- unless of course the webserver you contact is<br>
running Debian and affected by this bug!) Because this attacker can read<br>
the traffic inside Tor, they would also break your anonymity: they know<br>
both you and the destination(s) you asked for.</p>

<p>Worse, this attack works against past traffic too: what if an attacker<br>
logged traffic over the past two years? As long as there&#39;s a single<br>
non-weak non-colluding Tor relay in your circuit, you&#39;re fine -- that<br>
relay will provide encryption that the attacker can&#39;t break, then or<br>
now. But if you ever picked a path that consisted entirely of relays<br>
with broken RNGs, and an attacker logged this traffic, then he can unwrap<br>
the traffic from his logs using the same approach as above.</p>

<p>(Somebody who knows a Tor relay&#39;s private key could also impersonate that<br>
relay. So he can do a man-in-the-middle attack, intercepting your traffic<br>
to the &quot;real&quot; Tor relay and handling it himself. But this wouldn&#39;t give<br>
him anything that he can&#39;t already do just by watching. Another attack would<br>
be to create a fake descriptor and upload that. But this wouldn&#39;t give him<br>
anything he can&#39;t do by starting his own relay and uploading a descriptor for it.)</p>

<p>This evening we&#39;ve begun the process of making the directory authorities<br>
reject all uploaded descriptors that are signed using these keys, so<br>
we will effectively cut them out of the network. Peter Palfrader, our<br>
Tor debian package maintainer, has also put out a new deb package that<br>
will automatically discard the old relay keys when the relays upgrade,<br>
so they&#39;ll automatically generate new safe keys.</p>

<p>The next big issue is that three of the six v3 directory authorities<br>
were using weak keys for their directory votes and signatures. This<br>
issue doesn&#39;t affect Tor clients running the 0.1.2.x (stable) series,<br>
since those clients use the v2 directory system, none of whose keys<br>
(I think) are weak.</p>

<p>What can three v3 authorities do? If they could forge a new v3<br>
networkstatus consensus, they could trick users into using their own<br>
fabricated Tor network, which would totally ruin their anonymity. Worse,<br>
they could do this in a way that would be very hard to detect, by just<br>
giving out their forged consensus to a few target users and giving out<br>
the &quot;real&quot; consensus the rest of the time. But fortunately, Tor clients<br>
require a majority of signatures before they&#39;ll believe the consensus --<br>
and that&#39;s four of six. (Whew, that was close!)</p>

<p>Now, three v3 authorities can still influence the consensus a lot. As<br>
one example, they could pick their favorite relays (say, because they<br>
operate those relays, or because those are the ones that are easiest to<br>
monitor), and put in three votes claiming that all the other relays are<br>
unusable. The resulting consensus will then list only those relays as<br>
&quot;Running&quot;, since no other relays got enough votes. Then we&#39;re back to<br>
the above scenario. But in this case at least one other v3 authority<br>
would need to participate in building the consensus, so this couldn&#39;t be<br>
a selective one-off attack. The whole consensus would appear different<br>
to everybody, and hopefully somebody would notice.</p>

<p>The 0.2.0.26-rc release resolves these concerns by replacing those<br>
three weak identity keys with new strong ones. Once you upgrade, your<br>
new Tor won&#39;t trust any of those old keys -- so if anybody tries the<br>
above attacks on you, your Tor won&#39;t buy it.</p>

<p>And the last issue that affects non-Debian users? If you use a hidden<br>
service that generated its &quot;.onion&quot; key on a weak system, then you can<br>
no longer be sure that you&#39;re actually talking to the original person<br>
who generated the key. That&#39;s because somebody else might have figured<br>
out the private key for that service, and started advertising it himself.<br>
(Ordinarily, hidden services guarantee that nobody can intercept and read<br>
or modify your communications with the service, because only the person<br>
on the other end knows the private key that generated the &quot;.onion&quot; name.)</p>

<p>Now, what about the effects on Tor clients that run Debian, Ubuntu,<br>
or the like? Well, first they&#39;re affected by all the above attacks. And<br>
on top of that, any encryption they do can be considered to have no real<br>
effect. So for example if an attacker can observe your traffic either<br>
locally or at the first relay, he can see right through it all.</p>

<p>Similarly, if anybody has logs of traffic coming out of a Debian or Ubuntu<br>
Tor client, they can strip it of its encryption, and thus retroactively<br>
break the anonymity.</p>

<p>And lastly, don&#39;t forget there are plenty of other issues that this<br>
OpenSSL bug causes that are unrelated to Tor. As a simple example, if your<br>
bank generated its SSL cert on Debian or Ubuntu, then your SSL connection<br>
to your bank (likely including your password) is readable. Or if you ever<br>
tried to ssh into (or out of) an affected system, you have a problem. I<br>
imagine some broader lists of examples will start appearing soon.</p>

</div>


            </div>

            <div class="footer">
                <div class="pure-menu pure-menu-horizontal pure-menu-open">
                    <ul>
                        <li><a href="http://purecss.io/">About</a></li>
                        <li><a href="http://twitter.com/yuilibrary/">Twitter</a></li>
                        <li><a href="http://github.com/yahoo/pure/">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
