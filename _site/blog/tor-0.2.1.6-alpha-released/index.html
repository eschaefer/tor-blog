<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Tor 0.2.1.6-alpha Released</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A layout example that shows off a blog page with a list of posts.">
    <meta name="robots" content="noindex" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/styles.css">

    <!--[if lte IE 8]>
      <link rel="stylesheet" href="css/blog-old-ie.css">
    <![endif]-->
    <!--[if lt IE 9]>
      <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.js"></script>
    <![endif]-->
</head>
<body>

<body>
<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
        <div class="header">
            <a href="/"><img class="tor-logo" src="/assets/images/tor_logo.png" alt="Tor logo" /></a>
            <h1 class="brand-title">The Tor Project Blog</h1>
            <h2 class="brand-tagline">News and events from Tor</h2>

            <nav class="nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a class="pure-button" href="/events/">Events</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/overview">About Tor</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/donate/donate">Donate</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <div class="content pure-u-1 pure-u-md-3-4">
        <div>

            <!-- A wrapper for all the blog posts -->
<div class="posts">

  <div id="home">
      <section class="post">
        <header class="post-header">
          <h2 class="post-title"> <a href="">Tor 0.2.1.6-alpha Released</a></h2>
          <p class="post-meta">
              By <a class="post-author" href="#">phobos</a> under
              
                <a class="post-category post-category-js" href="#">alpha</a>
              
                <a class="post-category post-category-js" href="#">bug fixes</a>
               |
              15 Oct 2008
          </p>
        </header>
        <div class="post-description">
          <p>Tor 0.2.1.6-alpha further improves performance and robustness of hidden
services, starts work on supporting per-country relay selection, and
fixes a variety of smaller issues.</p>

<p>The original announcement can be found at
 <a href="http://archives.seul.org/or/talk/Oct-2008/msg00093.html" title="http://archives.seul.org/or/talk/Oct-2008/msg00093.html">http://archives.seul.org/or/talk/Oct-2008/msg00093.html</a></p>

<p>Changes in version 0.2.1.6-alpha - 2008-09-30</p>

<ul>
<li><p>Major features:</p>

<ul>
<li>Implement proposal 121: make it possible to build hidden services
that only certain clients are allowed to connect to. This is
enforced at several points, so that unauthorized clients are unable
to send INTRODUCE cells to the service, or even (depending on the
type of authentication) to learn introduction points. This feature
raises the bar for certain kinds of active attacks against hidden
services. Code by Karsten Loesing.</li>
<li>Relays now store and serve v2 hidden service descriptors by default,
i.e., the new default value for HidServDirectoryV2 is 1. This is
the last step in proposal 114, which aims to make hidden service
lookups more reliable.</li>
<li>Start work to allow node restrictions to include country codes. The
syntax to exclude nodes in a country with country code XX is
&quot;ExcludeNodes {XX}&quot;. Patch from Robert Hogan. It still needs some
refinement to decide what config options should take priority if
you ask to both use a particular node and exclude it.</li>
<li>Allow ExitNodes list to include IP ranges and country codes, just
like the Exclude*Nodes lists. Patch from Robert Hogan.</li>
</ul></li>
<li><p>Major bugfixes:</p>

<ul>
<li>Fix a bug when parsing ports in tor_addr_port_parse() that caused
Tor to fail to start if you had it configured to use a bridge
relay. Fixes bug 809. Bugfix on 0.2.1.5-alpha.</li>
<li>When extending a circuit to a hidden service directory to upload a
rendezvous descriptor using a BEGIN_DIR cell, almost 1/6 of all
requests failed, because the router descriptor had not been
downloaded yet. In these cases, we now wait until the router
descriptor is downloaded, and then retry. Likewise, clients
now skip over a hidden service directory if they don&#39;t yet have
its router descriptor, rather than futilely requesting it and
putting mysterious complaints in the logs. Fixes bug 767. Bugfix
on 0.2.0.10-alpha.</li>
<li>When fetching v0 and v2 rendezvous service descriptors in parallel,
we were failing the whole hidden service request when the v0
descriptor fetch fails, even if the v2 fetch is still pending and
might succeed. Similarly, if the last v2 fetch fails, we were
failing the whole hidden service request even if a v0 fetch is
still pending. Fixes bug 814. Bugfix on 0.2.0.10-alpha.</li>
<li>DNS replies need to have names matching their requests, but
these names should be in the questions section, not necessarily
in the answers section. Fixes bug 823. Bugfix on 0.2.1.5-alpha.</li>
</ul></li>
<li><p>Minor features:</p>

<ul>
<li>Update to the &quot;September 1 2008&quot; ip-to-country file.</li>
<li>Allow ports 465 and 587 in the default exit policy again. We had
rejected them in 0.1.0.15, because back in 2005 they were commonly
misconfigured and ended up as spam targets. We hear they are better
locked down these days.</li>
<li>Use a lockfile to make sure that two Tor processes are not
simultaneously running with the same datadir.</li>
<li>Serve the latest v3 networkstatus consensus via the control
port. Use &quot;getinfo dir/status-vote/current/consensus&quot; to fetch it.</li>
<li>Better logging about stability/reliability calculations on directory
servers.</li>
<li>Drop the requirement to have an open dir port for storing and
serving v2 hidden service descriptors.</li>
<li>Directory authorities now serve a /tor/dbg-stability.txt URL to
help debug WFU and MTBF calculations.</li>
<li>Implement most of Proposal 152: allow specialized servers to permit
single-hop circuits, and clients to use those servers to build
single-hop circuits when using a specialized controller. Patch
from Josh Albrecht. Resolves feature request 768.</li>
<li>Add a -p option to tor-resolve for specifying the SOCKS port: some
people find host:port too confusing.</li>
<li>Make TrackHostExit mappings expire a while after their last use, not
after their creation. Patch from Robert Hogan.</li>
<li>Provide circuit purposes along with circuit events to the controller.</li>
</ul></li>
<li><p>Minor bugfixes:</p>

<ul>
<li>Fix compile on OpenBSD 4.4-current. Bugfix on 0.2.1.5-alpha.
Reported by Tas.</li>
<li>Fixed some memory leaks -- some quite frequent, some almost
impossible to trigger -- based on results from Coverity.</li>
<li>When testing for libevent functions, set the LDFLAGS variable
correctly. Found by Riastradh.</li>
<li>Fix an assertion bug in parsing policy-related options; possible fix
for bug 811.</li>
<li>Catch and report a few more bootstrapping failure cases when Tor
fails to establish a TCP connection. Cleanup on 0.2.1.x.</li>
<li>Avoid a bug where the FastFirstHopPK 0 option would keep Tor from
bootstrapping with tunneled directory connections. Bugfix on
0.1.2.5-alpha. Fixes bug 797. Found by Erwin Lam.</li>
<li>When asked to connect to A.B.exit:80, if we don&#39;t know the IP for A
and we know that server B rejects most-but-not all connections to
port 80, we would previously reject the connection. Now, we assume
the user knows what they were asking for. Fixes bug 752. Bugfix
on 0.0.9rc5. Diagnosed by BarkerJr.</li>
<li>If we are not using BEGIN_DIR cells, don&#39;t attempt to contact hidden
service directories if they have no advertised dir port. Bugfix
on 0.2.0.10-alpha.</li>
<li>If we overrun our per-second write limits a little, count this as
having used up our write allocation for the second, and choke
outgoing directory writes. Previously, we had only counted this when
we had met our limits precisely. Fixes bug 824. Patch from by rovv.
Bugfix on 0.2.0.x (??).</li>
<li>Avoid a &quot;0 divided by 0&quot; calculation when calculating router uptime
at directory authorities. Bugfix on 0.2.0.8-alpha.</li>
<li>Make DNS resolved controller events into &quot;CLOSED&quot;, not
&quot;FAILED&quot;. Bugfix on 0.1.2.5-alpha. Fix by Robert Hogan. Resolves
bug 807.</li>
<li>Fix a bug where an unreachable relay would establish enough
reachability testing circuits to do a bandwidth test -- if
we already have a connection to the middle hop of the testing
circuit, then it could establish the last hop by using the existing
connection. Bugfix on 0.1.2.2-alpha, exposed when we made testing
circuits no longer use entry guards in 0.2.1.3-alpha.</li>
<li>If we have correct permissions on $datadir, we complain to stdout
and fail to start. But dangerous permissions on
$datadir/cached-status/ would cause us to open a log and complain
there. Now complain to stdout and fail to start in both cases. Fixes
bug 820, reported by seeess.</li>
<li>Remove the old v2 directory authority &#39;lefkada&#39; from the default
list. It has been gone for many months.</li>
</ul></li>
<li><p>Code simplifications and refactoring:</p>

<ul>
<li>Revise the connection_new functions so that a more typesafe variant
exists. This will work better with Coverity, and let us find any
actual mistakes we&#39;re making here.</li>
<li>Refactor unit testing logic so that dmalloc can be used sensibly
with unit tests to check for memory leaks.</li>
<li>Move all hidden-service related fields from connection and circuit
structure to substructures: this way they won&#39;t eat so much memory.</li>
</ul></li>
</ul>

        </div>
      </section>
  </div>

</div>



<div class="comments clearfix">
  <div class="comments-loading">
  <p><em>Comments will not load without Javascript enabled</em></p>
  </div>
</div>

<script type="text/javascript" class="juvia">
(function() {
    var loadingSection = document.body.querySelector('.comments-loading');
    var icon = '<p>Comments Loading...</p><img alt="loading comments" src="/assets/images/comments-loading.gif">';

    loadingSection.innerHTML = loadingSection.innerHTML + icon;

    var options = {
        container    : '.comments',
        site_key     : 'im3x57usjcg72fkm6lyqzwzt7vaoi4g',
        topic_key    : '/blog/tor-0.2.1.6-alpha-released',
        topic_url    : location.href,
        topic_title  : document.title || location.href,
        include_base : !window.Juvia,
        include_css  : !window.Juvia,
        comment_order: 'latest-first'
    };

    function makeQueryString(options) {
        var key, params = [];
        for (key in options) {
            params.push(
                encodeURIComponent(key) +
                '=' +
                encodeURIComponent(options[key]));
        }
        return params.join('&');
    }

    function makeApiUrl(options) {
        // Makes sure that each call generates a unique URL, otherwise
        // the browser may not actually perform the request.
        if (!('_juviaRequestCounter' in window)) {
            window._juviaRequestCounter = 0;
        }

        var result =
            'http://torblog-juvia-4525.herokuapp.com/api/show_topic.js' +
            '?_c=' + window._juviaRequestCounter +
            '&' + makeQueryString(options);
        window._juviaRequestCounter++;
        return result;
    }

    var s       = document.createElement('script');
    s.async     = true;
    s.type      = 'text/javascript';
    s.className = 'juvia';
    s.src       = makeApiUrl(options);

    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0] && commentsLoaded).appendChild(s);

})();
</script>


            <div class="footer">
                <div class="pure-menu pure-menu-horizontal pure-menu-open">
                    <ul>
                        <li><a href="http://purecss.io/">About</a></li>
                        <li><a href="http://twitter.com/yuilibrary/">Twitter</a></li>
                        <li><a href="http://github.com/yahoo/pure/">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
