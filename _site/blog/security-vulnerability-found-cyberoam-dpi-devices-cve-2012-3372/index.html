<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Security vulnerability found in Cyberoam DPI devices (CVE-2012-3372)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A layout example that shows off a blog page with a list of posts.">
    <meta name="robots" content="noindex" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/styles.css">

    <!--[if lte IE 8]>
      <link rel="stylesheet" href="css/blog-old-ie.css">
    <![endif]-->
    <!--[if lt IE 9]>
      <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.js"></script>
    <![endif]-->
</head>
<body>

<body>
<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
        <div class="header">
            <a href="/"><img class="tor-logo" src="/assets/images/tor_logo.png" alt="Tor logo" /></a>
            <h1 class="brand-title">The Tor Project Blog</h1>
            <h2 class="brand-tagline">News and events from Tor</h2>

            <nav class="nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a class="pure-button" href="/events/">Events</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/overview">About Tor</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/donate/donate">Donate</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <div class="content pure-u-1 pure-u-md-3-4">
        <div>

            <!-- A wrapper for all the blog posts -->
<div class="posts">

  <div id="home">
      <section class="post">
        <header class="post-header">
          <h2 class="post-title"> <a href="">Security vulnerability found in Cyberoam DPI devices (CVE-2012-3372)</a></h2>
          <p class="post-meta">
              By <a class="post-author" href="#">Runa</a> under
              
                <a class="post-category post-category-js" href="#">ca certificates</a>
              
                <a class="post-category post-category-js" href="#">dpi</a>
              
                <a class="post-category post-category-js" href="#">tor</a>
              
                <a class="post-category post-category-js" href="#">vulnerability</a>
               |
              03 Jul 2012
          </p>
        </header>
        <div class="post-description">
          <p>Last week, a user in Jordan reported seeing a fake certificate for <a href="https://torproject.org/">torproject.org</a>. The user did not report any errors when browsing to sites such as <a href="https://gmail.com">Gmail</a>, <a href="https://facebook.com">Facebook</a>, and <a href="https://twitter.com/">Twitter</a>, which suggests that this was a targeted attack. The certificate was issued by a company called <a href="http://www.cyberoam.com/">Cyberoam</a>. We first believed that this incident was similar to that of <a href="https://blog.torproject.org/blog/detecting-certificate-authority-compromises-and-web-browser-collusion">Comodo</a> and <a href="https://blog.torproject.org/blog/diginotar-debacle-and-what-you-should-do-about-it">DigiNotar</a>, and that Cyberoam had been tricked to issue a fake certificate for our website.</p>

<p><center>
<br>
<img src="https://media.torproject.org/image/blog-images/2012-07-03-screenshot-cyberoam-cropped.png"><br>
</center></p>

<p>After a bit of research, we learned that Cyberoam <a href="http://www.cyberoamworks.com/">make a range of devices</a> used for Deep Packet Inspection (DPI). The user was not just seeing a fake certificate for torproject.org, his connection was actually being intercepted by one of their devices. While investigating this further, Ben Laurie and I found a security vulnerability affecting all Cyberoam DPI devices.</p>

<p>Examination of a certificate chain generated by a Cyberoam DPI device shows that all such devices share the same CA certificate and hence the same private key. It is therefore possible to intercept traffic from any victim of a Cyberoam device with any other Cyberoam device - or to extract the key from the device and import it into other DPI devices, and use those for interception.</p>

<p>Ben and I wrote a <a href="https://media.torproject.org/misc/2012-07-03-cyberoam-CVE-2012-3372.txt">security advisory</a> and notified Cyberoam of this vulnerability at 17:00 UTC on Saturday, June 30. We made it clear that we intended to publish this blog post and the security advisory on Tuesday, July 3, and encouraged them to respond promptly if they had any comments. At the same time, we notified browser vendors and asked that they blacklist the Cyberoam CA certificate in their browsers.</p>

<p>Cyberoam have not yet commented on this issue, apart from acknowledging our first email and saying that they are looking into it. The Cyberoam CA certificate is not trusted, and so browsers will show users a warning (unless someone has already installed the certificate). Users with the Tor Browser Bundle are not affected.</p>

<p>To check if this CA is installed in your browser, see the following instructions for <a href="http://blog.devantis.com/?p=79">Internet Explorer, Firefox, Chrome</a>, and <a href="http://fairerplatform.com/2011/09/how-to-disable-diginotar-ssl-certificate/">Safari</a>. The instructions mention DigiNotar, but they are still valid. If you have more information about this issue, please email <a href="mailto:help@rt.torproject.org">help@rt.torproject.org</a>.</p>

        </div>
      </section>
  </div>

</div>



<div class="comments clearfix">
  <div class="comments-loading">
  <p><em>Comments will not load without Javascript enabled</em></p>
  </div>
</div>

<script type="text/javascript" class="juvia">
(function() {
    var loadingSection = document.body.querySelector('.comments-loading');
    var icon = '<p>Comments Loading...</p><img alt="loading comments" src="/assets/images/black-001-loading.gif">';

    loadingSection.innerHTML = loadingSection.innerHTML + icon;

    var options = {
        container    : '.comments',
        site_key     : 'im3x57usjcg72fkm6lyqzwzt7vaoi4g',
        topic_key    : '/blog/security-vulnerability-found-cyberoam-dpi-devices-cve-2012-3372',
        topic_url    : location.href,
        topic_title  : document.title || location.href,
        include_base : !window.Juvia,
        include_css  : !window.Juvia,
        comment_order: 'latest-first'
    };

    function makeQueryString(options) {
        var key, params = [];
        for (key in options) {
            params.push(
                encodeURIComponent(key) +
                '=' +
                encodeURIComponent(options[key]));
        }
        return params.join('&');
    }

    function makeApiUrl(options) {
        // Makes sure that each call generates a unique URL, otherwise
        // the browser may not actually perform the request.
        if (!('_juviaRequestCounter' in window)) {
            window._juviaRequestCounter = 0;
        }

        var result =
            'http://torblog-juvia-4525.herokuapp.com/api/show_topic.js' +
            '?_c=' + window._juviaRequestCounter +
            '&' + makeQueryString(options);
        window._juviaRequestCounter++;
        return result;
    }

    var s       = document.createElement('script');
    s.async     = true;
    s.type      = 'text/javascript';
    s.className = 'juvia';
    s.src       = makeApiUrl(options);

    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0] && commentsLoaded).appendChild(s);

})();
</script>


            <div class="footer">
                <div class="pure-menu pure-menu-horizontal pure-menu-open">
                    <ul>
                        <li><a href="http://purecss.io/">About</a></li>
                        <li><a href="http://twitter.com/yuilibrary/">Twitter</a></li>
                        <li><a href="http://github.com/yahoo/pure/">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
