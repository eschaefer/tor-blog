<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Iran blocks Tor; Tor releases same-day fix</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A layout example that shows off a blog page with a list of posts.">
    <meta name="robots" content="noindex" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/styles.css">

    <!--[if lte IE 8]>
      <link rel="stylesheet" href="css/blog-old-ie.css">
    <![endif]-->
    <!--[if lt IE 9]>
      <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.js"></script>
    <![endif]-->
</head>
<body>

<body>
<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
        <div class="header">
            <a href="/"><img class="tor-logo" src="/assets/images/tor_logo.png" alt="Tor logo" /></a>
            <h1 class="brand-title">The Tor Project Blog</h1>
            <h2 class="brand-tagline">News and events from Tor</h2>

            <nav class="nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a class="pure-button" href="/events/">Events</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/overview">About Tor</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/donate/donate">Donate</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <div class="content pure-u-1 pure-u-md-3-4">
        <div>

            <!-- A wrapper for all the blog posts -->
<div class="posts">

  <div id="home">
      <section class="post">
        <header class="post-header">
          <h2 class="post-title"> <a href="">Iran blocks Tor; Tor releases same-day fix</a></h2>
          <p class="post-meta">
              By <a class="post-author" href="#">arma</a> under
              
                <a class="post-category post-category-js" href="#">internet censorship</a>
              
                <a class="post-category post-category-js" href="#">iran</a>
               |
              14 Sep 2011
          </p>
        </header>
        <div class="post-description">
          <p><strong>The short version: Tor relays and bridges should upgrade to Tor 0.2.2.33 or Tor 0.2.3.4-alpha so users in Iran can reach them again.</strong></p>

<p>Yesterday morning (in our timezones â€” that evening, in Iran), Iran added a filter rule to their border routers that recognized Tor traffic and blocked it. Thanks to help from a variety of friends around the world, we quickly discovered how they were blocking it and released a <a href="http://archives.seul.org/tor/talk/Sep-2011/msg00187.html">new version of Tor</a> that isn&#39;t blocked. Fortunately, the fix is on the relay side: that means once enough <a href="https://torproject.org/docs/tor-doc-relay">relays</a> and <a href="https://www.torproject.org/docs/bridges">bridges</a> upgrade, the <a href="https://metrics.torproject.org/users.html?graph=direct-users&amp;start=2011-06-16&amp;end=2011-09-14&amp;country=ir&amp;dpi=72#direct-users">many tens of thousands of Tor users in Iran</a> will resume being able to reach the Tor network, without needing to change their software.</p>

<p>How did the filter work technically? Tor tries to make its traffic look like a web browser talking to an https web server, but if you look carefully enough you can tell some differences. In this case, the characteristic of Tor&#39;s SSL handshake they looked at was the expiry time for our SSL session certificates: we rotate the session certificates every two hours, whereas normal SSL certificates you get from a <a href="https://blog.torproject.org/blog/detecting-certificate-authority-compromises-and-web-browser-collusion">certificate</a> <a href="https://blog.torproject.org/blog/diginotar-debacle-and-what-you-should-do-about-it">authority</a> typically last a year or more. The fix was to simply write a larger expiration time on the certificates, so our certs have <a href="https://www.eff.org/observatory">more plausible</a> expiry times.</p>

<p>There are plenty of interesting discussion points from the research angle around how this arms race should be played. We&#39;re working on <a href="https://gitweb.torproject.org/torspec.git/blob/HEAD:/proposals/176-revising-handshake.txt">medium</a> <a href="https://gitweb.torproject.org/torspec.git/blob/HEAD:/proposals/179-TLS-cert-and-parameter-normalization.txt">term</a> and <a href="https://gitweb.torproject.org/torspec.git/blob/HEAD:/proposals/180-pluggable-transport.txt">longer term</a> solutions, but in the short term, there are other ways to filter Tor traffic like the one Iran used. Should we fix them all preemptively, meaning the next time they block us it will be through some more complex mechanism that&#39;s harder to figure out? Or should we leave things as they are, knowing there will be more blocking events but also knowing that we can solve them easily? Given that their last blocking attempt was in <a href="https://blog.torproject.org/blog/update-internet-censorship-iran">January 2011</a>, I think it&#39;s smartest to collect some more data points first.</p>

<p>It&#39;s too early to have cool graphs showing a drop in users and then the users coming back a day or so later. I&#39;ll plan to add these graphs once things play out more. [Update: <a href="https://metrics.torproject.org/users.html?graph=direct-users&amp;start=2011-07-01&amp;end=2011-09-18&amp;country=ir&amp;events=on&amp;dpi=72#direct-users">here is the graph as of Sept 16</a>]</p>

        </div>
      </section>
  </div>

</div>

<div class="comments"></div>

<script type="text/javascript" class="juvia">
(function() {
    var options = {
        container    : '.comments',
        site_key     : 'im3x57usjcg72fkm6lyqzwzt7vaoi4g',
        topic_key    : '/blog/iran-blocks-tor-tor-releases-same-day-fix',
        topic_url    : location.href,
        topic_title  : document.title || location.href,
        include_base : !window.Juvia,
        include_css  : !window.Juvia,
        comment_order: 'latest-first'
    };

    function makeQueryString(options) {
        var key, params = [];
        for (key in options) {
            params.push(
                encodeURIComponent(key) +
                '=' +
                encodeURIComponent(options[key]));
        }
        return params.join('&');
    }

    function makeApiUrl(options) {
        // Makes sure that each call generates a unique URL, otherwise
        // the browser may not actually perform the request.
        if (!('_juviaRequestCounter' in window)) {
            window._juviaRequestCounter = 0;
        }

        var result =
            'http://torblog-juvia-4525.herokuapp.com/api/show_topic.js' +
            '?_c=' + window._juviaRequestCounter +
            '&' + makeQueryString(options);
        window._juviaRequestCounter++;
        return result;
    }

    var s       = document.createElement('script');
    s.async     = true;
    s.type      = 'text/javascript';
    s.className = 'juvia';
    s.src       = makeApiUrl(options);
    (document.getElementsByTagName('head')[0] ||
     document.getElementsByTagName('body')[0]).appendChild(s);
})();
</script>


            <div class="footer">
                <div class="pure-menu pure-menu-horizontal pure-menu-open">
                    <ul>
                        <li><a href="http://purecss.io/">About</a></li>
                        <li><a href="http://twitter.com/yuilibrary/">Twitter</a></li>
                        <li><a href="http://github.com/yahoo/pure/">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
