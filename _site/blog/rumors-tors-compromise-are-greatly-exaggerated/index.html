<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Rumors of Tor's compromise are greatly exaggerated</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A layout example that shows off a blog page with a list of posts.">
    <meta name="robots" content="noindex" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/styles.css">

    <!--[if lte IE 8]>
      <link rel="stylesheet" href="css/blog-old-ie.css">
    <![endif]-->
    <!--[if lt IE 9]>
      <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.js"></script>
    <![endif]-->
</head>
<body>

<body>
<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
        <div class="header">
            <a href="/"><img class="tor-logo" src="/assets/images/tor_logo.png" alt="Tor logo" /></a>
            <h1 class="brand-title">The Tor Project Blog</h1>
            <h2 class="brand-tagline">News and events from Tor</h2>

            <nav class="nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a class="pure-button" href="/events/">Events</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/overview">About Tor</a>
                    </li>
                    <li class="nav-item">
                        <a class="pure-button" href="https://www.torproject.org/donate/donate">Donate</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <div class="content pure-u-1 pure-u-md-3-4">
        <div>

            <!-- A wrapper for all the blog posts -->
<div class="posts">

  <div id="home">
      <section class="post">
        <header class="post-header">
          <h2 class="post-title"> <a href="">Rumors of Tor's compromise are greatly exaggerated</a></h2>
          <p class="post-meta">
              By <a class="post-author" href="#">phobos</a> under
              
                <a class="post-category post-category-js" href="#">anonymity research</a>
              
                <a class="post-category post-category-js" href="#">attacks on tor</a>
              
                <a class="post-category post-category-js" href="#">facts</a>
              
                <a class="post-category post-category-js" href="#">freedom hosting</a>
              
                <a class="post-category post-category-js" href="#">hidden services</a>
              
                <a class="post-category post-category-js" href="#">research</a>
              
                <a class="post-category post-category-js" href="#">tor compromise</a>
              
                <a class="post-category post-category-js" href="#">winning the attention economy</a>
               |
              25 Oct 2011
          </p>
        </header>
        <div class="post-description">
          <p>There are two recent stories claiming the Tor network is compromised. It seems it is easier to get press than to publish research, work with us on the details, and propose solutions. Our comments here are based upon the same stories you are reading. We have no insider information.</p>

<p>The first story has been around &#39;Freedom Hosting&#39; and their hosting of child abuse materials as exposed by <a href="http://arstechnica.com/business/news/2011/10/anonymous-takes-down-darknet-child-porn-site-on-tor-network.ars">Anonymous Operation Darknet</a>. We&#39;re reading the press articles, pastebin urls, and talking to the same people as you. It appears &#39;Anonymous&#39; cracked the Apache/PHP/MySQL setup at Freedom Hosting and published some, or all, of their users in the database. These sites happened to be hosted on a <a href="https://www.torproject.org/docs/hidden-services.html.en">Tor hidden service</a>. Further, &#39;Anonymous&#39; used a somewhat recent RAM-exhaustion denial of service attack on the &#39;Freedom Hosting&#39; Apache server. It&#39;s a simple resource starvation attack that can be conducted over low bandwidth, low resource requirement connections to individual hosts. This isn&#39;t an attack on Tor, but rather an attack on some software behind a Tor hidden service. This attack was discussed in a thread on the <a href="https://lists.torproject.org/pipermail/tor-talk/2011-October/021822.html">tor-talk</a> mailing list starting October 19th.</p>

<p>The second story is around Eric Filiol&#39;s claims of compromising the Tor network leading up to his Hackers to Hackers talk in Brazil in a few days. This claim was initially announced by some French websites; however, it has spread further, such as this <a href="http://thehackernews.com/2011/10/tor-anonymizing-network-compromised-by.html">Hacker News</a> story.</p>

<p>Again, the <a href="https://lists.torproject.org/pipermail/tor-talk/2011-October/021722.html">tor-talk</a> mailing list had the first discussions of these attacks back on October 13th. To be clear, neither Eric nor his researchers have disclosed anything about this attack to us. They have not talked to us, nor shared any data with us — despite some mail exchanges where we reminded him about the phrase &quot;responsible disclosure&quot;.</p>

<p>Here&#39;s the attack as we understand it, from reading the various press reports:</p>

<p>They enumerated 6000 IP addresses that they think are Tor relays. There aren&#39;t that many Tor relays in the world — <a href="https://metrics.torproject.org/network.html">2500</a> is a more accurate number. We&#39;re not sure what caused them to overcount so much. Perhaps they watched the Tor network over a matter of weeks and collected a bunch of addresses that aren&#39;t relays anymore? The set of relays is public information, so there&#39;s no reason to collect your own list and certainly no reason to end up with a wrong list.</p>

<p>One-third of the machines on those IP addresses are vulnerable to operating system or other system level attacks, meaning he can break in. That&#39;s quite a few! We wonder if that&#39;s true with the real Tor network, or just their simulated one? Even ignoring the question of what these 3500 extra IP addresses are, it&#39;s important to remember that one-third by number is not at all the same as one-third by capacity: Tor clients load-balance over relays based on the relay capacity, so any useful statement should be about how much of the <em>capacity</em> of the Tor network is vulnerable. It would indeed be shocking if one-third of the Tor network by capacity is vulnerable to external attacks.</p>

<p>(There&#39;s also an aside about enumerating <a href="https://www.torproject.org/docs/bridges">bridges</a>. They say they found 181 bridges, and then there&#39;s a quote saying they &quot;now have a complete picture of the topography of Tor&quot;, which is a particularly unfortunate time for that quote since there are currently around 600 bridges running.)</p>

<p>We expect the talk will include discussion about some cool Windows trick that can modify the crypto keys in a running Tor relay that you have local system access to; but it&#39;s simpler and smarter just to say that when the attacker has local system access to a Tor relay, the attacker controls the relay.</p>

<p>Once they&#39;ve broken into some relays, they do congestion attacks like <a href="http://freehaven.net/anonbib/#torspinISC08">packet spinning</a> to congest the relays they couldn&#39;t compromise, to drive users toward the relays they own. It&#39;s unclear how many resources are needed to keep the rest of the relays continuously occupied long enough to keep the user from using them. There are probably some better heuristics that clients can use to distinguish between a loaded relay and an unavailable relay; we look forward to learning how well their attack here actually worked.</p>

<p>From there, the attack gets vague. The only hint we have is this nonsense sentence from the article:</p>

<blockquote>
<p>The remaining flow can then be decrypted via a fully method of attack called &quot;to clear unknown&quot; based on statistical analysis.</p>
</blockquote>

<p>Do they have a new attack on AES, or on OpenSSL&#39;s implementation of it, or on our use of OpenSSL? Or are they instead doing some sort of timing attack, where if you own the client&#39;s first hop and also the destination you can use statistics to confirm that the two flows are on the same circuit? There&#39;s a history of <a href="https://blog.torproject.org/blog/one-cell-enough">confused researchers</a> proclaiming some sort of novel active attack when passive correlation attacks are much simpler and just as effective.</p>

<p>So the summary of the attack might be &quot;take control of the nodes you can, then congest the other ones so your targets avoid them and use the nodes you control. Then do some unspecified magic crypto attack to defeat the layers of encryption for later hops in the circuit.&quot; But really, these are just guesses based on the same news articles you&#39;re reading. We look forwarding to finding out if there&#39;s actually an attack we can fix, or if they are just playing all the journalists to get attention.</p>

<p>More generally, there are two broader lessons to remember here. First, research into anonymity-breaking attacks is how the field moves forward, and using Tor for your target is <a href="http://freehaven.net/anonbib/">common</a> because a) it&#39;s resistant to all the simpler attacks and b) we make it <a href="https://www.torproject.org/getinvolved/research.html.en">really easy</a> to do your research on. And second, remember that most other anonymity systems out there fall to these attacks so quickly and thoroughly that no researchers even talk about it anymore. For some recent examples, see the single-hop proxy discussions in <a href="http://freehaven.net/anonbib/#tissec-latency-leak">How Much Anonymity does Network Latency Leak?</a> and <a href="http://freehaven.net/anonbib/#wpes11-panchenko">Website Fingerprinting in Onion Routing Based Anonymization Networks</a>.</p>

<p>I thank Roger, Nick, and Runa for helping with this post.</p>

        </div>
      </section>
  </div>

</div>



<div class="comments clearfix">
  <div class="comments-loading">
  <p><em>Comments will not load without Javascript enabled</em></p>
  </div>
</div>

<script type="text/javascript" class="juvia">
(function() {
    var loadingSection = document.body.querySelector('.comments-loading');
    var icon = '<p>Comments Loading...</p><img alt="loading comments" src="/assets/images/black-001-loading.gif">';

    loadingSection.innerHTML = loadingSection.innerHTML + icon;

    var options = {
        container    : '.comments',
        site_key     : 'im3x57usjcg72fkm6lyqzwzt7vaoi4g',
        topic_key    : '/blog/rumors-tors-compromise-are-greatly-exaggerated',
        topic_url    : location.href,
        topic_title  : document.title || location.href,
        include_base : !window.Juvia,
        include_css  : !window.Juvia,
        comment_order: 'latest-first'
    };

    function makeQueryString(options) {
        var key, params = [];
        for (key in options) {
            params.push(
                encodeURIComponent(key) +
                '=' +
                encodeURIComponent(options[key]));
        }
        return params.join('&');
    }

    function makeApiUrl(options) {
        // Makes sure that each call generates a unique URL, otherwise
        // the browser may not actually perform the request.
        if (!('_juviaRequestCounter' in window)) {
            window._juviaRequestCounter = 0;
        }

        var result =
            'http://torblog-juvia-4525.herokuapp.com/api/show_topic.js' +
            '?_c=' + window._juviaRequestCounter +
            '&' + makeQueryString(options);
        window._juviaRequestCounter++;
        return result;
    }

    var s       = document.createElement('script');
    s.async     = true;
    s.type      = 'text/javascript';
    s.className = 'juvia';
    s.src       = makeApiUrl(options);

    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0] && commentsLoaded).appendChild(s);

})();
</script>


            <div class="footer">
                <div class="pure-menu pure-menu-horizontal pure-menu-open">
                    <ul>
                        <li><a href="http://purecss.io/">About</a></li>
                        <li><a href="http://twitter.com/yuilibrary/">Twitter</a></li>
                        <li><a href="http://github.com/yahoo/pure/">GitHub</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
